<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Live TinyMCE Editor ‚Üí HTML Preview</title>
  <!-- TinyMCE CDN (no API key for quick demos; use your own key in production) -->
  <script src="https://cdn.tiny.cloud/1/77hf2rpmdbg9kr1u3pc0mtubhufo2i7u9syer0ulphm40zl7/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #11182b;
      --accent: #6ca4ff;
      --text: #e8eefc;
      --muted: #a9b7d9;
      --border: #1e2a48;
    }
    html, body { height: 100%; }
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(120deg, #0b1020 0%, #0f1530 100%);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }
    header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(17, 24, 43, 0.7);
      backdrop-filter: blur(6px);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header h1 { font-size: 16px; font-weight: 600; margin: 0; color: var(--text); }
    header .sub { color: var(--muted); font-size: 12px; }
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      padding: 14px;
      height: calc(100% - 62px);
      box-sizing: border-box;
    }
    .panel {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.1));
      border-radius: 16px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 0; /* required for flex children to shrink */
      box-shadow: 0 6px 24px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.03);
    }
    .panel-header {
      display: flex; align-items: center; justify-content: space-between;
      gap: 8px; padding: 10px 12px; border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,0.02);
    }
    .panel-header h2 { margin: 0; font-size: 14px; font-weight: 600; color: var(--text); }
    .panel-body { position: relative; flex: 1; min-height: 0; }

    /* Preview */
    #preview {
      padding: 18px; height: 100%; overflow: auto; background: #0e1426;
    }
    #preview :where(h1,h2,h3,h4,h5,h6) { color: #f1f5ff; }
    #preview :where(p,li,blockquote,code,pre) { color: #dbe6ff; }
    #preview a { color: var(--accent); }
    #preview table { border-collapse: collapse; width: 100%; }
    #preview th, #preview td { border: 1px solid #2a3961; padding: 8px; }

    /* Source */
    #source {
      width: 100%; height: 100%; box-sizing: border-box; border: none; outline: none;
      background: #0e1426; color: #dbe6ff; padding: 12px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      resize: none;
    }

    /* Buttons */
    .btns { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn {
      border: 1px solid var(--border);
      background: #0f1730;
      color: var(--text);
      padding: 8px 10px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 12px;
      transition: transform .05s ease, background .2s ease, border .2s ease;
    }
    .btn:hover { background: #121e3d; border-color: #2a3961; }
    .btn:active { transform: translateY(1px); }

    /* Responsive */
    @media (max-width: 1080px) {
      .container { grid-template-columns: 1fr; height: auto; }
      .panel { min-height: 320px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Live TinyMCE Editor ‚Üí HTML Preview</h1>
    <div class="sub">Type on the left, see rendered HTML on the right. Copy or download the HTML anytime.</div>
  </header>

  <div class="container">
    <!-- Editor Panel -->
    <section class="panel" aria-label="Editor">
      <div class="panel-header">
        <h2>Editor</h2>
        <div class="btns">
          <button id="btn-insert-sample" class="btn" title="Insert sample content">Insert sample</button>
          <button id="btn-clear" class="btn" title="Clear editor">Clear</button>
        </div>
      </div>
      <div class="panel-body">
        <textarea id="editor"></textarea>
      </div>
    </section>

    <!-- Preview Panel -->
    <section class="panel" aria-label="Preview and HTML Source">
      <div class="panel-header">
        <h2>Preview</h2>
        <div class="btns">
          <button id="btn-copy" class="btn">Copy HTML</button>
          <button id="btn-download" class="btn">Download HTML</button>
          <button id="btn-toggle-source" class="btn" title="Toggle HTML source panel">Show Source</button>
          <a class="btn-copy" href="/">Homepage<i class="ki-filled ki-arrow-up"></a>
        </div>
      </div>
      <div class="panel-body" style="display: grid; grid-template-rows: 1fr auto;">
        <div id="preview" aria-live="polite"></div>
        <div id="source-wrap" style="display:none; border-top: 1px solid var(--border); height: 220px;">
          <textarea id="source" readonly></textarea>
        </div>
      </div>
    </section>
  </div>

  <script>
    // TinyMCE Initialization
    tinymce.init({
      selector: '#editor',
      height: 520,
      menubar: true,
      branding: false,
      plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount code preview autoresize',
      toolbar: [
        'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | forecolor backcolor removeformat',
        '| alignleft aligncenter alignright alignjustify | outdent indent | bullist numlist checklist',
        '| link image media table | emoticons charmap codesample | code preview'
      ].join(' '),
      content_style: 'body { font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding: 12px; }',
      setup: (editor) => {
        const update = debounce(() => {
          const html = editor.getContent({ format: 'html' });
          updatePreview(html);
        }, 120);

        editor.on('init', () => {
          // Seed with minimal content
          const starter = '<h2>Welcome üëã</h2>\n<p>Edit this content in <strong>TinyMCE</strong> and see the live preview on the right.</p>\n<ul><li>Supports <em>formatting</em>, lists, tables, media, and more.</li><li>Click <code>Copy HTML</code> or <code>Download HTML</code> when ready.</li></ul>';
          editor.setContent(starter);
          updatePreview(starter);
        });

        editor.on('change input undo redo keyup SetContent', update);
      }
    });

    // Live preview + source sync
    function updatePreview(html) {
      const preview = document.getElementById('preview');
      const source = document.getElementById('source');
      preview.innerHTML = html || '';
      source.value = html || '';
    }

    // Debounce utility
    function debounce(fn, wait) {
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn.apply(null, args), wait); };
    }

    // Buttons
    document.getElementById('btn-copy').addEventListener('click', async () => {
      const html = tinymce.activeEditor ? tinymce.activeEditor.getContent() : '';
      try {
        await navigator.clipboard.writeText(html);
        flash('Copied HTML to clipboard');
      } catch (e) {
        console.error(e);
        alert('Copy failed. Your browser may block clipboard access on this page.');
      }
    });

    document.getElementById('btn-download').addEventListener('click', () => {
      const html = tinymce.activeEditor ? tinymce.activeEditor.getContent() : '';
      const fullDoc = `<!doctype html>\n<html lang="en">\n<head>\n<meta charset="utf-8" />\n<meta name="viewport" content="width=device-width, initial-scale=1"/>\n<title>Exported from TinyMCE</title>\n</head>\n<body>\n${html}\n</body>\n</html>`;
      const blob = new Blob([fullDoc], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'tiny-export.html';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });

    document.getElementById('btn-toggle-source').addEventListener('click', (e) => {
      const wrap = document.getElementById('source-wrap');
      const showing = wrap.style.display !== 'none';
      wrap.style.display = showing ? 'none' : 'block';
      e.currentTarget.textContent = showing ? 'Show Source' : 'Hide Source';
    });

    document.getElementById('btn-clear').addEventListener('click', () => {
      const ed = tinymce.activeEditor; if (!ed) return;
      ed.setContent('');
      updatePreview('');
    });

    document.getElementById('btn-insert-sample').addEventListener('click', () => {
      const ed = tinymce.activeEditor; if (!ed) return;
      const sample = `
        <h1>Sample Article</h1>
        <p>This is a <strong>sample</strong> showing common elements.</p>
        <h3>List</h3>
        <ul>
          <li>One</li>
          <li>Two</li>
          <li>Three</li>
        </ul>
        <h3>Table</h3>
        <table>
          <thead><tr><th>Feature</th><th>Support</th></tr></thead>
          <tbody><tr><td>Bold/Italic</td><td>‚úÖ</td></tr>
                 <tr><td>Lists</td><td>‚úÖ</td></tr>
                 <tr><td>Tables</td><td>‚úÖ</td></tr></tbody>
        </table>
        <blockquote>‚ÄúGood design is as little design as possible.‚Äù ‚Äî Dieter Rams</blockquote>
      `;
      ed.insertContent(sample);
    });

    // Tiny toast helper
    function flash(msg) {
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.position = 'fixed';
      el.style.bottom = '18px';
      el.style.right = '18px';
      el.style.padding = '10px 12px';
      el.style.background = 'rgba(20,32,64,0.9)';
      el.style.color = 'white';
      el.style.border = '1px solid #2a3961';
      el.style.borderRadius = '10px';
      el.style.fontSize = '12px';
      el.style.boxShadow = '0 10px 24px rgba(0,0,0,0.35)';
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 1700);
    }
  </script>
</body>
</html>
